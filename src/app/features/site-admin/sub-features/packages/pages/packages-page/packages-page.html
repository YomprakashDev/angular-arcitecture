@if(isLoading()){
<div class="loading-overlay" aria-live="polite">
  <mat-progress-spinner
    mode="indeterminate"
    diameter="48"
    aria-label="Loading"
  ></mat-progress-spinner>
</div>
} @if(!isLoading() && !isAddView()){
<div class="page">
  <div class="page-header">
    <h1>Packages</h1>
    <button (click)="toggleAddView()" class="primary-btn">Create New Package</button>
  </div>

  <div class="table-wrap">
    <table matSort mat-table [dataSource]="dataSource" class="mat-elev-0 packages-table">
      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let pkg">
          <button mat-icon-button aria-label="View module">
            <lucide-angular [img]="viewIcon" class="text-[#787A7F] text-lg"></lucide-angular>
          </button>
          <button mat-icon-button aria-label="Edit module">
            <lucide-angular [img]="editIcon" class="text-[#787A7F] text-lg"></lucide-angular>
          </button>
        </td>
      </ng-container>

      <!-- Status -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let pkg">
          <label class="switch">
            <input type="checkbox" disabled [checked]="pkg.status" />
            />
            <span class="slider"></span>
          </label>
        </td>
      </ng-container>

      <!-- Package Name -->
      <ng-container matColumnDef="packageName">
        <th mat-header-cell *matHeaderCellDef>Package Name</th>
        <td mat-cell *matCellDef="let pkg" class="muted-strong">
          {{ pkg.packageName }}
        </td>
      </ng-container>

      <!-- Modules (as pills) -->
      <ng-container matColumnDef="modules">
        <th mat-header-cell *matHeaderCellDef>Modules</th>
        <td mat-cell *matCellDef="let pkg">
          <span class="pill" *ngFor="let m of pkg.modules">{{ m }}</span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</div>

} @if(isAddView()){
<app-add-view-packages></app-add-view-packages>
}
