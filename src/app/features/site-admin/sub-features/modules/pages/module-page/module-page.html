<div class="flex bg-white w-full ">
  <div class="flex-1 p-6">
    <div class="flex justify-between w-full">
      <h1 class="text-2xl mb-4 font-bold text-[#1D1D21]">Modules</h1>
      <!-- <app-button text="Export to Excel" variant="primary" ></app-button> -->
    </div>
     <div class="module-table shadow-lg rounded-lg overflow-hidden relative">
     
<!-- overlay spinner while loading -->
      <div class="loading-overlay" *ngIf="isLoading()">
        <mat-progress-spinner mode="indeterminate" diameter="48" aria-label="Loading"></mat-progress-spinner>
      </div>
      
  
      <table
        matSort

        mat-table
        [dataSource]="dataSource"
        cdkDropList
 
        class="w-full bg-white"
      >
        <ng-container matColumnDef="actions">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="p-4 text-left text-sm font-bold text-gray-700 tracking-wider"
          >
            Actions
          </th>
          <td mat-cell *matCellDef="let module" class="p-4 whitespace-nowrap flex items-center">
            <span cdkDragHandle class="drag-handle mr-2 cursor-move" aria-label="Drag handle">
              <lucide-angular [img]="dragIcon"></lucide-angular>
            </span>
            @if (editingModuleId() !== module.id) {
            <button
       
              mat-icon-button
              class="edit-icon"
              aria-label="Edit module"
            >
           <lucide-angular [img]="editIcon" class="edit-icon"></lucide-angular>
            </button>
            } @else {
            <button
        
              mat-icon-button
              color="primary"
              aria-label="Savemodule"      
            >
              <mat-icon>save</mat-icon>
            </button>
            <button  mat-icon-button color="warn" aria-label="Cancel edit">
              <mat-icon>cancel</mat-icon>
            </button>
            }
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="p-4 text-left text-sm font-bold text-gray-700 tracking-wider"
          >
            Status
          </th>
          <td mat-cell *matCellDef="let module" class="p-4 whitespace-nowrap">
            <label class="switch">
              <input
                type="checkbox"
                [disabled]="editingModuleId() !== module.id"
                [checked]="module.status"
        
              />
              />
              <span class="slider"></span>
            </label>
          </td>
        </ng-container>

        <ng-container matColumnDef="moduleName">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            sortActionDescription="Sort by module name"
            class="p-4 text-left text-sm font-bold text-gray-700 tracking-wider"
          >
            Module Name
          </th>
          <td mat-cell *matCellDef="let module" class="p-4 whitespace-nowrap">
            @if (editingModuleId() !== module.id) {
            {{ module.moduleName }}
            } @else {
            <mat-form-field appearance="outline" class="edit-field w-full">
              <input
                matInput
                [value]="editedModuleName()"
                (input)="editedModuleName.set($event.target.value)"
                placeholder="Module name"
              />
            </mat-form-field>
            }
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            sortActionDescription="Sort by description"
            class="p-4 text-left text-sm font-bold text-gray-700 tracking-wider"
          >
            Description
          </th>
          <td mat-cell *matCellDef="let module" class="p-4">
            @if (editingModuleId() !== module.id) {
            {{ module.description }}
            } @else {
            <mat-form-field appearance="outline" class="edit-field w-full">
              <input
                matInput
                [value]="editedModuleDescription()"
                (input)="editedModuleDescription.set($event.target.value)"
                placeholder="Description"
              />
            </mat-form-field>
            }
          </td>
        </ng-container>

        <ng-container matColumnDef="icon">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="p-4 text-left text-sm font-bold text-gray-700 tracking-wider"
          >
            Icon
          </th>
          <td mat-cell *matCellDef="let module" class="p-4 whitespace-nowrap">
            <mat-icon class="module-icon">{{ module.icon }}</mat-icon>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-50"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          cdkDrag
          [cdkDragData]="row"
          class="border-b border-gray-200 hover:bg-gray-100"
        ></tr>
      </table>
    
      <!-- <div class="flex items-center justify-between mt-4 px-3">
        <p class="text-sm text-[#182330] font-semibold">
          Showing 1 to 5 entries of {{ module()?.currentPage }} entries
        </p> -->
        <!-- <div>
          <mat-paginator
            [length]="dataSource.data.length"
            [pageSize]="6"
            [pageSizeOptions]="[6]"
            #paginator
            style="display: none"
          ></mat-paginator>

          <div class="flex justify-end items-center mt-4 space-x-4">
            <!-- Previous -->
            <!-- <button
              class="border border-[#CAC6D3] rounded"
              mat-icon-button
              (click)="paginator.previousPage()"
              [disabled]="paginator.hasPreviousPage() === false"
            >
              <mat-icon>chevron_left</mat-icon>
            </button> -->

            <!-- Current Page -->
            <!-- <span class="bg-[#6D7BFA] text-white px-3 py-1 rounded">{{
              paginator.pageIndex + 1
            }}</span> -->

            <!-- Next -->
            <!-- <button
              class="border border-[#CAC6D3] rounded"
              mat-icon-button
              (click)="paginator.nextPage()"
              [disabled]="paginator.hasNextPage() === false"
            >
              <mat-icon>chevron_right</mat-icon>
            </button> -->
          <!-- </div> -->
        <!-- </div> --> 
      <!-- </div> -->
    </div>
  </div>

</div>



