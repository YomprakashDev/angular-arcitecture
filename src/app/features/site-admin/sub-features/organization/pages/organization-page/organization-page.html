@if (isLoading()){
<div class="loading-overlay">
  <mat-progress-spinner
    mode="indeterminate"
    diameter="48"
    aria-label="Loading"
  ></mat-progress-spinner>
</div>
} @if (!isLoading()){
<div class="flex w-full h-full bg-white rounded-lg">
  <div class="flex-1 p-6">
    <div class="flex items-center justify-between">
      <h1 class="text-2xl font-bold text-[#1D1D21]">Organizations List</h1>
      <app-button
        (clicked)="addOrganization()"
        text="Add Organization"
        variant="primary"
      ></app-button>
    </div>

    <div class="flex items-center justify-center p-4">
      <div class="flex items-center justify-between w-full">
        <app-tabs
          [tabs]="tabs()"
          (tabChanged)="setActiveTab($event.id)"
          [defaultActiveTab]="'active'"
        >
        </app-tabs>

        <!-- Search and Export -->
        <div class="flex items-center space-x-4">
          <div class="relative w-72">
            <svg
              class="absolute text-gray-400 transform -translate-y-1/2 left-3 top-1/2"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input
              type="text"
              placeholder="Search here"
              class="w-full pl-10 pr-4 py-2 rounded-lg placeholder:text-[#787A7F] font-normal border border-[#d9d9d9] focus:outline-none text-sm"
            />
          </div>

          <app-button text="Export" variant="secondary"></app-button>
        </div>
      </div>
    </div>

    <div class="card">
      <table mat-table [dataSource]="dataSource" class="orgs-table mat-elev-0">
        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let org">
            <div class="actions">
              <button mat-icon-button matTooltip="View" aria-label="View">
                <mat-icon>visibility</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Edit" aria-label="Edit">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Duplicate" aria-label="Duplicate">
                <mat-icon>content_copy</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Settings" aria-label="Settings">
                <mat-icon>settings</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Download" aria-label="Download">
                <mat-icon>cloud_download</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Open" aria-label="Open">
                <mat-icon>open_in_new</mat-icon>
              </button>
              <button mat-icon-button matTooltip="Delete" aria-label="Delete">
                <mat-icon>delete_outline</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <!-- Organization Name -->
        <ng-container matColumnDef="organization">
          <th mat-header-cell *matHeaderCellDef>Organization Name</th>
          <td mat-cell *matCellDef="let org" class="muted-strong">
            {{ org.orgDetails.organizationName }}
          </td>
        </ng-container>

        <!-- Contact Person -->
        <ng-container matColumnDef="contactPerson">
          <th mat-header-cell *matHeaderCellDef>Contact Person</th>
          <td mat-cell *matCellDef="let org">
            {{ org.contactDetails.contactPersonName }}
          </td>
        </ng-container>

        <!-- Email -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Email</th>
          <td mat-cell *matCellDef="let org">
            <a class="link" [href]="'mailto:' + org.contactDetails.emailID">
              {{ org.contactDetails.emailID }}
            </a>
          </td>
        </ng-container>

        <!-- Phone -->
        <ng-container matColumnDef="phone">
          <th mat-header-cell *matHeaderCellDef>Phone</th>
          <td mat-cell *matCellDef="let org">
            {{ org.contactDetails.contactNumber }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </div>
</div>
} @if (isAddOrganizationModalOpen()){

<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-[80%]">
    <!-- header -->
    <div class="flex items-center justify-between px-4 py-6 shadow-[0px_6px_6px_0px_#00000008]">
      <h2 class="text-xl font-bold">Add Company Details</h2>
      <div><app-stepper [currentStep]="currentStep()"></app-stepper></div>
      <button (click)="closeModal()" class="text-gray-500 hover:text-gray-700">
        <lucide-angular [img]="closeIcon" class="w-6 h-6"></lucide-angular>
      </button>
    </div>

    <!-- body slot -->
    <div class="p-4">
      <app-add-organization-form [currentFormIndex]="currentStep()"></app-add-organization-form>
    </div>

    <div class="flex items-center justify-center space-x-4 p-4">
      @if (!isFirstStep()) {
      <button
        type="button"
        (click)="prevStep()"
        class="flex items-center gap-2 px-4 py-2 border border-[#7E7A88] font-bold text-[#7E7A88] bg-transparent rounded"
      >
        Previous
      </button>
      }@else{
      <button
        type="button"
        (click)="closeModal()"
        class="flex items-center gap-2 px-4 py-2 border border-[#7E7A88] font-bold text-[#7E7A88] bg-transparent rounded"
      >
        Cancel</button
      >} @if (!isLastStep()) {
      <button
        type="button"
        (click)="updateCurrentStep()"
        class="flex items-center gap-2 px-4 py-2 text-white bg-[#6D7BFA] rounded"
      >
        Next
      </button>
      } @else {
      <button
        type="button"
        class="flex items-center gap-2 px-4 py-2 text-white bg-[#6D7BFA] rounded"
      >
        Save
      </button>
      }
    </div>
  </div>
</div>
}
